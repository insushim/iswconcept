import type { GeneratedLesson } from '@/types/lesson';

export const generateTeachingScriptPrompt = (lesson: GeneratedLesson, grade: number): string => {
  return `당신은 경력 20년의 우수 초등교사입니다.
주어진 수업 설계를 바탕으로 실제 수업에서 사용할 수 있는 상세한 수업 진행 대본을 작성합니다.

## 수업 설계 정보

${JSON.stringify(lesson, null, 2)}

## 학년: ${grade}학년

## 수업 대본 작성 요청

다음 JSON 형식으로 수업 대본을 작성하세요. JSON 외의 다른 텍스트는 포함하지 마세요.

{
  "lessonScript": {
    "opening": {
      "greeting": "여러분, 안녕하세요! 선생님과 함께 재미있는 수업을 시작해 볼까요?",
      "motivation": "동기 유발을 위한 교사 발언",
      "objectiveShare": "오늘 우리가 함께 탐구할 내용을 안내합니다."
    },
    "stages": [
      {
        "stageName": "관계맺기",
        "timing": "0:00 - 5:00",
        "sections": [
          {
            "activity": "동기유발 활동",
            "teacherSays": [
              "T: (자료를 보여주며) 여러분, 이것을 한번 볼까요?",
              "T: 무엇이 보이나요? 손을 들어 이야기해 봅시다.",
              "T: (학생 발표 후) 네, 좋은 관찰이에요. 또 다른 생각이 있나요?",
              "T: 오늘 우리는 이것과 관련해서 탐구해 볼 거예요."
            ],
            "expectedStudentResponses": [
              "S1: ○○이 보여요.",
              "S2: △△ 같아요.",
              "S3: 왜 □□일까요?"
            ],
            "teacherNotes": [
              "모든 학생이 자료를 볼 수 있도록 확인",
              "다양한 반응을 수용적으로 받아들이기",
              "오개념이 있어도 이 단계에서는 수정하지 않음"
            ],
            "transition": "자, 이제 오늘 탐구할 내용에 대해 더 알아볼까요?"
          }
        ]
      },
      {
        "stageName": "집중하기",
        "timing": "5:00 - 12:00",
        "sections": [
          {
            "activity": "핵심 개념 소개",
            "teacherSays": [
              "T: 오늘 우리가 탐구할 핵심 개념은 '○○'입니다.",
              "T: ○○이란 무엇일까요?",
              "T: 우리 주변에서 ○○의 예시를 찾아볼까요?",
              "T: 오늘의 탐구 질문은 '△△'입니다."
            ],
            "expectedStudentResponses": [
              "S: ○○은 □□인 것 같아요.",
              "S: △△에서 볼 수 있어요."
            ],
            "teacherNotes": [
              "핵심 개념을 명확하게 제시",
              "학생들의 초기 이해 파악"
            ],
            "transition": "이제 이 개념을 더 깊이 탐구해 봅시다."
          }
        ]
      },
      {
        "stageName": "조사하기",
        "timing": "12:00 - 24:00",
        "sections": [
          {
            "activity": "탐구 활동 안내",
            "teacherSays": [
              "T: 이제 모둠별로 탐구 활동을 해 볼 거예요.",
              "T: 활동 순서를 설명할게요. (순서 안내)",
              "T: 각 모둠에 자료를 나눠드릴게요.",
              "T: 질문이 있으면 손을 들어주세요."
            ],
            "teacherNotes": [
              "활동 순서를 명확히 안내",
              "자료 배부"
            ]
          },
          {
            "activity": "모둠별 탐구",
            "teacherSays": [
              "T: (순회 지도하며) 이 모둠은 어떤 것을 발견했나요?",
              "T: 좋아요. 왜 그렇게 생각했나요?",
              "T: 다른 관점에서도 생각해 볼까요?",
              "T: 이것과 저것의 공통점은 무엇일까요?"
            ],
            "scaffoldingQuestions": [
              "어떤 공통점이 보이나요?",
              "왜 그런 현상이 일어났을까요?",
              "다른 경우에도 똑같이 적용될까요?"
            ],
            "teacherNotes": [
              "모든 모둠 순회 지도",
              "스캐폴딩 질문으로 탐구 촉진",
              "시간 관리"
            ]
          },
          {
            "activity": "탐구 결과 공유",
            "teacherSays": [
              "T: 자, 이제 발견한 내용을 함께 나눠볼까요?",
              "T: 1모둠부터 발표해 주세요.",
              "T: (발표 후) 좋은 발견이에요. 다른 모둠도 비슷한 것을 발견했나요?"
            ],
            "transition": "여러분이 발견한 내용을 정리해 봅시다."
          }
        ]
      },
      {
        "stageName": "조직 및 정리하기",
        "timing": "24:00 - 30:00",
        "sections": [
          {
            "activity": "정보 정리",
            "teacherSays": [
              "T: 발견한 내용을 정리해 볼까요?",
              "T: 이 그래픽 조직자에 정리해 봅시다.",
              "T: 공통점은 무엇이고, 차이점은 무엇인가요?",
              "T: 어떤 패턴이 보이나요?"
            ],
            "expectedStudentResponses": [
              "S: 공통점은 ○○이에요.",
              "S: △△와 □□가 연결되어 있어요."
            ],
            "teacherNotes": [
              "그래픽 조직자 활용 안내",
              "패턴 발견 촉진"
            ],
            "transition": "이제 우리가 발견한 것에서 중요한 아이디어를 찾아봅시다."
          }
        ]
      },
      {
        "stageName": "일반화하기",
        "timing": "30:00 - 35:00",
        "sections": [
          {
            "activity": "일반화 도출",
            "teacherSays": [
              "T: 우리가 조사한 내용을 정리해 봅시다.",
              "T: 이 사례들에서 공통적으로 발견한 것은 무엇인가요?",
              "T: 그렇다면, '○○은/는 △△하다'라고 말할 수 있을까요?",
              "T: (학생 일반화 발표 후) 이 생각을 다른 말로 표현해 볼 사람?",
              "T: 우리가 발견한 중요한 아이디어를 함께 정리해 봅시다."
            ],
            "keyQuestions": [
              "이 패턴이 다른 상황에서도 적용될까요?",
              "우리가 발견한 것을 한 문장으로 말해볼까요?"
            ],
            "teacherNotes": [
              "학생들이 직접 일반화를 도출하도록 기다림",
              "다양한 표현 격려",
              "일반화 문장 기록"
            ],
            "transition": "이제 배운 것을 새로운 상황에 적용해 봅시다."
          }
        ]
      },
      {
        "stageName": "전이하기",
        "timing": "35:00 - 38:00",
        "sections": [
          {
            "activity": "전이 활동",
            "teacherSays": [
              "T: 우리가 발견한 아이디어가 다른 상황에도 적용되는지 확인해 볼까요?",
              "T: 이 새로운 상황에서는 어떻게 될까요?",
              "T: 배운 개념을 적용해서 설명해 봅시다."
            ],
            "expectedStudentResponses": [
              "S: 이 경우에도 ○○가 적용될 것 같아요.",
              "S: 왜냐하면 △△이기 때문이에요."
            ],
            "teacherNotes": [
              "새로운 맥락 제시",
              "개념 적용 촉진"
            ],
            "transition": "오늘 수업을 마무리하며 돌아봅시다."
          }
        ]
      },
      {
        "stageName": "성찰하기",
        "timing": "38:00 - 40:00",
        "sections": [
          {
            "activity": "학습 성찰",
            "teacherSays": [
              "T: 오늘 수업을 마무리하며 생각해 봅시다.",
              "T: 수업 전에는 ○○에 대해 어떻게 생각했나요?",
              "T: 지금은 어떻게 생각이 바뀌었나요?",
              "T: 오늘 배운 것 중 가장 중요한 것은 무엇인가요?",
              "T: 더 알고 싶은 것이 있나요?"
            ],
            "expectedStudentResponses": [
              "S: 예전에는 ○○라고 생각했는데, 지금은 △△라고 생각해요.",
              "S: □□가 더 궁금해요."
            ],
            "closingRemarks": "다음 시간에는 이 개념을 더 확장해서 탐구해 보겠습니다. 오늘 수고했어요!"
          }
        ]
      }
    ],
    "closing": {
      "summary": "오늘 우리는 ○○에 대해 탐구하며 △△라는 중요한 아이디어를 발견했습니다.",
      "preview": "다음 시간에는 이 개념을 더 확장하여 □□에 대해 탐구해 보겠습니다.",
      "assignment": "",
      "farewell": "오늘 열심히 탐구한 여러분, 수고했어요!"
    },
    "contingencyPlans": {
      "timeShortage": "전이하기 활동을 간소화하고 성찰하기에서 핵심만 다룸",
      "studentStruggle": "추가 예시 제공, 소그룹 지도, 또래 도움 활용",
      "fastFinishers": "심화 탐구 질문 제공, 동료 학습 지원 역할 부여"
    }
  }
}

## 대본 작성 원칙

1. **자연스러운 화법**: ${grade}학년 학생들이 이해할 수 있는 자연스러운 말투 사용
2. **발문의 다양성**: 열린 질문, 확인 질문, 심화 질문 적절히 배치
3. **기다림의 시간**: 발문 후 학생 사고 시간 확보 (3-5초)
4. **긍정적 피드백**: 학생 반응에 대한 구체적 칭찬
5. **전이 연결**: 단계 간 자연스러운 전환 발언

반드시 유효한 JSON 형식으로만 응답하세요.`;
};
