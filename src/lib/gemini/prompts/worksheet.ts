import type { GeneratedLesson } from '@/types/lesson';

export const generateWorksheetPrompt = (lesson: GeneratedLesson, grade: number, subject: string): string => {
  // ë‹¨ì› ì „ì²´ ì •ë³´ ì¶”ì¶œ
  const totalPeriods = lesson.unitOverview?.totalPeriods || 10;
  const unitTitle = lesson.unitOverview?.unitName || lesson.lessonOverview.title;
  const conceptLens = lesson.unitOverview?.conceptLens || lesson.lessonOverview.coreConcepts?.[0] || 'í•µì‹¬ ê°œë…';
  const bigIdea = lesson.unitOverview?.unitKeyIdea || '';
  // íƒêµ¬ì§ˆë¬¸ì€ generalizations ë°°ì—´ì˜ ì²« ë²ˆì§¸ í•­ëª©ì—ì„œ ê°€ì ¸ì˜´
  const firstGen = lesson.unitOverview?.generalizations?.[0];
  const factualQ = firstGen?.inquiryQuestions?.factual || '';
  const conceptualQ = firstGen?.inquiryQuestions?.conceptual || '';
  const debatableQ = firstGen?.inquiryQuestions?.debatable || '';

  return `ë‹¨ì› ì „ì²´(${totalPeriods}ì°¨ì‹œ)ì— ëŒ€í•œ **ì‹¤ì œ í•™ìŠµì§€**ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

## âš ï¸ ì¤‘ìš”: í•™ìŠµì§€ëŠ” "í™œë™ ëª©ë¡"ì´ ì•„ë‹™ë‹ˆë‹¤!

í•™ìŠµì§€ëŠ” í•™ìƒì´ **ì§ì ‘ ì‘ì„±**í•  ìˆ˜ ìˆëŠ” í˜•íƒœì—¬ì•¼ í•©ë‹ˆë‹¤:
- âœ… ë¹ˆì¹¸ ì±„ìš°ê¸° ë¬¸ì œ (ì‹¤ì œ í•™ìŠµ ë‚´ìš©ì— ê¸°ë°˜í•œ)
- âœ… í‘œ, ì°¨íŠ¸, ê·¸ë˜í”½ ì¡°ì§ì (ë¹ˆ ì¹¸ìœ¼ë¡œ ì œê³µ)
- âœ… ë‹¨ë‹µí˜•/ì„œìˆ í˜• ì§ˆë¬¸ (êµ¬ì²´ì ì¸ ì§ˆë¬¸)
- âœ… ì„ ê¸‹ê¸°, ë¶„ë¥˜í•˜ê¸° í™œë™
- âœ… ê·¸ë¦¼ ê·¸ë¦¬ê¸°/ë‹¤ì´ì–´ê·¸ë¨ ì™„ì„±í•˜ê¸° ê³µê°„
- âŒ ë‹¨ìˆœ í™œë™ ì„¤ëª…ë§Œ ë‚˜ì—´í•˜ëŠ” ê²ƒì€ í•™ìŠµì§€ê°€ ì•„ë‹˜

## ë‹¨ì› ì •ë³´

**ë‹¨ì›ëª…**: ${unitTitle}
**ì´ ì°¨ì‹œ**: ${totalPeriods}ì°¨ì‹œ
**í•™ë…„**: ${grade}í•™ë…„
**ê³¼ëª©**: ${subject}
**ê°œë… ë Œì¦ˆ**: ${conceptLens}
**ë¹… ì•„ì´ë””ì–´**: ${bigIdea}
**íƒêµ¬ ì§ˆë¬¸**:
- (ì‚¬) ${factualQ}
- (ê°œ) ${conceptualQ}
- (ë…¼) ${debatableQ}

### ë‹¨ì› ê°œìš”
${JSON.stringify(lesson.unitOverview || lesson.lessonOverview, null, 2)}

### 7ë‹¨ê³„ ì„¤ê³„
${JSON.stringify(lesson.stages, null, 2)}

### ë‹¨ì› í‰ê°€
${JSON.stringify(lesson.unitAssessment || {}, null, 2)}

## í•™ìŠµì§€ ìƒì„± ìš”ì²­

ë‹¤ìŒ JSON í˜•ì‹ìœ¼ë¡œ **ë‹¨ì› ì „ì²´**ì˜ ì‹¤ì œ í•™ìŠµì§€ ë‚´ìš©ì„ ìƒì„±í•˜ì„¸ìš”.
**ê° ë‹¨ê³„ë§ˆë‹¤ í•™ìƒì´ ì‹¤ì œë¡œ ì‘ì„±í•  ìˆ˜ ìˆëŠ” êµ¬ì²´ì ì¸ í™œë™ì§€ ë‚´ìš©ì„ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.**
JSON ì™¸ì˜ ë‹¤ë¥¸ í…ìŠ¤íŠ¸ëŠ” í¬í•¨í•˜ì§€ ë§ˆì„¸ìš”.

{
  "worksheet": {
    "header": {
      "title": "${unitTitle} íƒêµ¬ í•™ìŠµì§€",
      "subtitle": "ì „ë¶í˜• CBI 7ë‹¨ê³„ íƒêµ¬",
      "subject": "${subject}",
      "grade": "${grade}í•™ë…„",
      "totalPeriods": "${totalPeriods}ì°¨ì‹œ",
      "conceptLens": "${conceptLens}",
      "studentNameField": true,
      "dateField": true,
      "classField": true
    },
    "sections": [
      {
        "id": "section-engage",
        "sectionNumber": 1,
        "title": "ğŸ”— 1ë‹¨ê³„: ê´€ê³„ë§ºê¸° (Engage)",
        "stage": "engage",
        "periods": "1ì°¨ì‹œ",
        "phase": "ê°œë…ì¸ì‹",
        "stageColor": "#F59E0B",
        "instructions": "ë‹¤ìŒ ìë£Œë¥¼ ê´€ì°°í•˜ê³  ì§ˆë¬¸ì— ë‹µí•´ ë´…ì‹œë‹¤.",
        "questions": [
          {
            "id": "q1",
            "number": 1,
            "type": "see_think_wonder",
            "question": "ã€ë³´ê³ -ìƒê°í•˜ê³ -ê¶ê¸ˆí•´í•˜ê¸°ã€‘ (ë‹¨ì› ì£¼ì œì™€ ê´€ë ¨ëœ êµ¬ì²´ì ì¸ ìë£Œ ì„¤ëª…ì„ ì—¬ê¸°ì— ì œì‹œ)",
            "subQuestions": [
              {
                "label": "ğŸ‘€ ë¬´ì—‡ì´ ë³´ì´ë‚˜ìš”?",
                "lines": 2
              },
              {
                "label": "ğŸ¤” ì–´ë–¤ ìƒê°ì´ ë“œë‚˜ìš”?",
                "lines": 2
              },
              {
                "label": "â“ ë¬´ì—‡ì´ ê¶ê¸ˆí•œê°€ìš”?",
                "lines": 2
              }
            ]
          },
          {
            "id": "q2",
            "number": 2,
            "type": "experience_connection",
            "question": "ì´ê²ƒê³¼ ë¹„ìŠ·í•œ ë‚˜ì˜ ê²½í—˜ì„ ë– ì˜¬ë ¤ ë´…ì‹œë‹¤.",
            "prompt": "(êµ¬ì²´ì ì¸ ê²½í—˜ ì—°ê²° ì§ˆë¬¸ - ë‹¨ì› ë‚´ìš©ì— ë§ê²Œ)",
            "lines": 3
          },
          {
            "id": "q3",
            "number": 3,
            "type": "initial_thinking",
            "question": "ã€ë‚˜ì˜ ì²« ìƒê°ã€‘ - ë‹¨ì›ì´ ëë‚œ í›„ ë‹¤ì‹œ í™•ì¸í•´ ë³¼ ê±°ì˜ˆìš”!",
            "prompt": "'${conceptLens}'ì— ëŒ€í•´ ì§€ê¸ˆ ì•Œê³  ìˆê±°ë‚˜ ìƒê°í•˜ëŠ” ê²ƒì„ ììœ ë¡­ê²Œ ì ì–´ë´…ì‹œë‹¤.",
            "lines": 4,
            "box": true
          }
        ]
      },
      {
        "id": "section-focus",
        "sectionNumber": 2,
        "title": "ğŸ¯ 2ë‹¨ê³„: ì§‘ì¤‘í•˜ê¸° (Focus)",
        "stage": "focus",
        "periods": "2ì°¨ì‹œ",
        "phase": "ê°œë…ì¸ì‹",
        "stageColor": "#3B82F6",
        "instructions": "í•µì‹¬ ê°œë…ì„ íƒìƒ‰í•˜ê³  ì •ì˜í•´ ë´…ì‹œë‹¤.",
        "questions": [
          {
            "id": "q4",
            "number": 4,
            "type": "frayer_model",
            "question": "ã€í”„ë ˆì´ì–´ ëª¨ë¸ã€‘ '${conceptLens}'ì„(ë¥¼) ì •ë¦¬í•´ ë´…ì‹œë‹¤.",
            "quadrants": [
              {"position": "top-left", "label": "ì •ì˜ (ë‚˜ì˜ ë§ë¡œ)", "lines": 3},
              {"position": "top-right", "label": "íŠ¹ì§•", "lines": 3},
              {"position": "bottom-left", "label": "ì˜ˆì‹œ", "lines": 3},
              {"position": "bottom-right", "label": "ë¹„ì˜ˆì‹œ (ì•„ë‹Œ ê²ƒ)", "lines": 3}
            ],
            "centerConcept": "${conceptLens}"
          },
          {
            "id": "q5",
            "number": 5,
            "type": "fill_blank",
            "question": "ã€ë¹ˆì¹¸ ì±„ìš°ê¸°ã€‘ í•µì‹¬ ê°œë… ì´í•´í•˜ê¸°",
            "blanks": [
              "(ë‹¨ì› í•µì‹¬ ë‚´ìš©ì— ê¸°ë°˜í•œ ë¹ˆì¹¸ ì±„ìš°ê¸° ë¬¸ì¥ 1)",
              "(ë‹¨ì› í•µì‹¬ ë‚´ìš©ì— ê¸°ë°˜í•œ ë¹ˆì¹¸ ì±„ìš°ê¸° ë¬¸ì¥ 2)",
              "(ë‹¨ì› í•µì‹¬ ë‚´ìš©ì— ê¸°ë°˜í•œ ë¹ˆì¹¸ ì±„ìš°ê¸° ë¬¸ì¥ 3)"
            ]
          },
          {
            "id": "q6",
            "number": 6,
            "type": "inquiry_start",
            "question": "ã€íƒêµ¬ ì§ˆë¬¸ì— ëŒ€í•œ ë‚˜ì˜ ì²« ìƒê°ã€‘",
            "subQuestions": [
              {
                "label": "(ì‚¬) ì‚¬ì‹¤ì  ì§ˆë¬¸: ${factualQ || '(ì‚¬ì‹¤ì  ì§ˆë¬¸)'}",
                "prompt": "â†’ ë‚˜ì˜ ì²« ìƒê°:",
                "lines": 2
              },
              {
                "label": "(ê°œ) ê°œë…ì  ì§ˆë¬¸: ${conceptualQ || '(ê°œë…ì  ì§ˆë¬¸)'}",
                "prompt": "â†’ ë‚˜ì˜ ì²« ìƒê°:",
                "lines": 2
              }
            ]
          }
        ]
      },
      {
        "id": "section-investigate",
        "sectionNumber": 3,
        "title": "ğŸ”¬ 3ë‹¨ê³„: ì¡°ì‚¬í•˜ê¸° (Investigate)",
        "stage": "investigate",
        "periods": "3-4ì°¨ì‹œ",
        "phase": "ê°œë…ì—°ê²°",
        "stageColor": "#10B981",
        "instructions": "ë‹¤ì–‘í•œ ì‚¬ë¡€ë¥¼ íƒêµ¬í•˜ê³  ë°œê²¬í•œ ê²ƒì„ ê¸°ë¡í•©ë‹ˆë‹¤.",
        "questions": [
          {
            "id": "q7",
            "number": 7,
            "type": "investigation_table",
            "question": "ã€íƒêµ¬ ê¸°ë¡í‘œã€‘ (ë‹¨ì›ì— ë§ëŠ” êµ¬ì²´ì ì¸ íƒêµ¬ ì£¼ì œë“¤)",
            "tableHeaders": ["íƒêµ¬ ì‚¬ë¡€", "ê´€ì°°/ì¡°ì‚¬ ë‚´ìš©", "ë°œê²¬í•œ íŠ¹ì§•", "í•µì‹¬ ê°œë…ê³¼ì˜ ì—°ê²°"],
            "rows": [
              {"case": "(ì‚¬ë¡€ 1 - êµ¬ì²´ì  ì´ë¦„)", "cells": ["", "", ""]},
              {"case": "(ì‚¬ë¡€ 2 - êµ¬ì²´ì  ì´ë¦„)", "cells": ["", "", ""]},
              {"case": "(ì‚¬ë¡€ 3 - êµ¬ì²´ì  ì´ë¦„)", "cells": ["", "", ""]},
              {"case": "(ì‚¬ë¡€ 4 - êµ¬ì²´ì  ì´ë¦„)", "cells": ["", "", ""]}
            ],
            "note": "â€» ëª¨ë‘ ë³„ë¡œ ë§¡ì€ ì‚¬ë¡€ë¥¼ ì¡°ì‚¬í•˜ê³  ê¸°ë¡í•˜ì„¸ìš”."
          },
          {
            "id": "q8",
            "number": 8,
            "type": "pattern_finding",
            "question": "ã€íŒ¨í„´ ì°¾ê¸°ã€‘ íƒêµ¬í•œ ì‚¬ë¡€ë“¤ì—ì„œ ê³µí†µì ì„ ì°¾ì•„ë´…ì‹œë‹¤.",
            "subQuestions": [
              {"label": "ëª¨ë“  ì‚¬ë¡€ì—ì„œ ê³µí†µìœ¼ë¡œ ë°œê²¬í•œ ê²ƒ:", "lines": 2},
              {"label": "ì™œ ì´ëŸ° ê³µí†µì ì´ ìˆì„ê¹Œìš”?", "lines": 2}
            ]
          },
          {
            "id": "q9",
            "number": 9,
            "type": "short_answer",
            "question": "ã€ì‹¬í™” ì§ˆë¬¸ã€‘ (ë‹¨ì› ë‚´ìš©ì— ê¸°ë°˜í•œ ì‚¬ê³  ì´‰ì§„ ì§ˆë¬¸)",
            "prompt": "(êµ¬ì²´ì ì¸ ì§ˆë¬¸ ë‚´ìš©)",
            "lines": 3
          }
        ]
      },
      {
        "id": "section-organize",
        "sectionNumber": 4,
        "title": "ğŸ“Š 4ë‹¨ê³„: ì¡°ì§ ë° ì •ë¦¬í•˜ê¸° (Organize)",
        "stage": "organize",
        "periods": "5-6ì°¨ì‹œ",
        "phase": "ê°œë…ì—°ê²°",
        "stageColor": "#8B5CF6",
        "instructions": "ë°œê²¬í•œ ë‚´ìš©ì„ ë¶„ë¥˜í•˜ê³  ì¡°ì§í™”í•´ ë´…ì‹œë‹¤.",
        "questions": [
          {
            "id": "q10",
            "number": 10,
            "type": "compare_contrast_table",
            "question": "ã€êµì°¨ë¹„êµì°¨íŠ¸ã€‘ ì‚¬ë¡€ë“¤ì˜ ê³µí†µì ê³¼ ì°¨ì´ì  ì •ë¦¬",
            "tableHeaders": ["ë¹„êµ í•­ëª©", "(ì‚¬ë¡€A)", "(ì‚¬ë¡€B)", "ê³µí†µì ", "ì°¨ì´ì "],
            "rows": [
              {"item": "(ë¹„êµ í•­ëª© 1)", "cells": ["", "", "", ""]},
              {"item": "(ë¹„êµ í•­ëª© 2)", "cells": ["", "", "", ""]},
              {"item": "(ë¹„êµ í•­ëª© 3)", "cells": ["", "", "", ""]}
            ]
          },
          {
            "id": "q11",
            "number": 11,
            "type": "concept_map",
            "question": "ã€ê°œë… ë§µã€‘ '${conceptLens}'ì„(ë¥¼) ì¤‘ì‹¬ìœ¼ë¡œ ê´€ê³„ë„ë¥¼ ê·¸ë ¤ë´…ì‹œë‹¤.",
            "centerConcept": "${conceptLens}",
            "branches": 4,
            "instructions": "ê°€ìš´ë°ì— í•µì‹¬ ê°œë…ì„ ì“°ê³ , ê´€ë ¨ëœ ë‚´ìš©ì„ ì—°ê²°í•´ ë´…ì‹œë‹¤.",
            "drawingSpace": true
          },
          {
            "id": "q12",
            "number": 12,
            "type": "summary",
            "question": "ã€ì •ë¦¬í•˜ê¸°ã€‘ ë°œê²¬í•œ íŒ¨í„´ì„ ì •ë¦¬í•´ ë´…ì‹œë‹¤.",
            "subQuestions": [
              {"label": "ëª¨ë“  ì‚¬ë¡€ì—ì„œ ë°˜ë³µë˜ëŠ” íŒ¨í„´:", "lines": 2},
              {"label": "ì´ íŒ¨í„´ì´ ì˜ë¯¸í•˜ëŠ” ê²ƒ:", "lines": 2},
              {"label": "ì´ê²ƒì´ ì¤‘ìš”í•œ ì´ìœ :", "lines": 2}
            ]
          }
        ]
      },
      {
        "id": "section-generalize",
        "sectionNumber": 5,
        "title": "ğŸ’¡ 5ë‹¨ê³„: ì¼ë°˜í™”í•˜ê¸° (Generalize)",
        "stage": "generalize",
        "periods": "7ì°¨ì‹œ",
        "phase": "ê°œë…ì „ì´",
        "stageColor": "#EC4899",
        "instructions": "ë°œê²¬í•œ íŒ¨í„´ì—ì„œ ë¹… ì•„ì´ë””ì–´(ì¼ë°˜í™”)ë¥¼ ë„ì¶œí•´ ë´…ì‹œë‹¤.",
        "questions": [
          {
            "id": "q13",
            "number": 13,
            "type": "headlines",
            "question": "ã€í—¤ë“œë¼ì¸ ë£¨í‹´ã€‘ ì˜¤ëŠ˜ì˜ ê°€ì¥ ì¤‘ìš”í•œ ë°œê²¬ì„ ì‹ ë¬¸ í—¤ë“œë¼ì¸ì²˜ëŸ¼ í‘œí˜„í•´ ë´…ì‹œë‹¤.",
            "prompt": "ìš°ë¦¬ê°€ ë°œê²¬í•œ ê²ƒ í•œ ì¤„ë¡œ:",
            "lines": 2,
            "box": true
          },
          {
            "id": "q14",
            "number": 14,
            "type": "generalization_builder",
            "question": "ã€ë¹… ì•„ì´ë””ì–´ ë§Œë“¤ê¸°ã€‘ ì¼ë°˜í™” ë¬¸ì¥ì„ ì™„ì„±í•´ ë´…ì‹œë‹¤.",
            "template": "\"___(í•µì‹¬ ê°œë…)___ì€/ëŠ” ___(ì´ìœ /ì›ë¦¬)___í•˜ê¸° ë•Œë¬¸ì— ___(ê²°ê³¼/íŠ¹ì„±)___í•˜ë‹¤.\"",
            "steps": [
              {"label": "í•µì‹¬ ê°œë…:", "hint": "(ë¬´ì—‡ì— ê´€í•œ ê²ƒì¸ê°€?)", "lines": 1},
              {"label": "ì´ìœ /ì›ë¦¬:", "hint": "(ì™œ ê·¸ëŸ°ê°€?)", "lines": 1},
              {"label": "ê²°ê³¼/íŠ¹ì„±:", "hint": "(ì–´ë–¤ ê²°ê³¼ê°€ ë‚˜íƒ€ë‚˜ëŠ”ê°€?)", "lines": 1}
            ],
            "finalStatement": {
              "label": "ë‚˜ì˜ ë¹… ì•„ì´ë””ì–´ (ì¼ë°˜í™” ë¬¸ì¥):",
              "lines": 2,
              "highlight": true
            }
          },
          {
            "id": "q15",
            "number": 15,
            "type": "class_consensus",
            "question": "ã€ìš°ë¦¬ ë°˜ì˜ ë¹… ì•„ì´ë””ì–´ã€‘ í† ë¡  í›„ í•©ì˜í•œ ë‚´ìš©ì„ ì ì–´ë´…ì‹œë‹¤.",
            "lines": 3,
            "box": true,
            "highlight": true
          },
          {
            "id": "q16",
            "number": 16,
            "type": "transfer_thinking",
            "question": "ã€ì „ì´ ìƒê°í•˜ê¸°ã€‘ ì´ ë¹… ì•„ì´ë””ì–´ê°€ ì ìš©ë  ìˆ˜ ìˆëŠ” ë‹¤ë¥¸ ìƒí™©ì€?",
            "prompt": "ìš°ë¦¬ê°€ ë°œê²¬í•œ ë¹… ì•„ì´ë””ì–´ëŠ” ì´ëŸ° ìƒí™©ì—ì„œë„ ì ìš©ë  ìˆ˜ ìˆì–´ìš”:",
            "lines": 3
          }
        ]
      },
      {
        "id": "section-transfer",
        "sectionNumber": 6,
        "title": "ğŸš€ 6ë‹¨ê³„: ì „ì´í•˜ê¸° (Transfer)",
        "stage": "transfer",
        "periods": "8-9ì°¨ì‹œ",
        "phase": "ê°œë…ì „ì´",
        "stageColor": "#06B6D4",
        "instructions": "ë°°ìš´ ê°œë…ì„ ìƒˆë¡œìš´ ìƒí™©ì— ì ìš©í•˜ëŠ” ìˆ˜í–‰ê³¼ì œë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.",
        "questions": [
          {
            "id": "q17",
            "number": 17,
            "type": "grasps_understanding",
            "question": "ã€ìˆ˜í–‰ê³¼ì œ ì´í•´í•˜ê¸°ã€‘ GRASPS ìš”ì†Œë¥¼ í™•ì¸í•´ ë´…ì‹œë‹¤.",
            "elements": [
              {"icon": "ğŸ¯", "label": "ëª©í‘œ(G)", "prompt": "ë‚´ê°€ ë‹¬ì„±í•´ì•¼ í•  ëª©í‘œ:", "lines": 1},
              {"icon": "ğŸ­", "label": "ì—­í• (R)", "prompt": "ë‚´ê°€ ë§¡ì€ ì—­í• :", "lines": 1},
              {"icon": "ğŸ‘¥", "label": "ì²­ì¤‘(A)", "prompt": "ëˆ„êµ¬ì—ê²Œ ë³´ì—¬ì¤„ ê²ƒì¸ì§€:", "lines": 1},
              {"icon": "ğŸ“", "label": "ìƒí™©(S)", "prompt": "ì–´ë–¤ ìƒí™©ì¸ì§€:", "lines": 1},
              {"icon": "ğŸ“¦", "label": "ì‚°ì¶œë¬¼(P)", "prompt": "ë¬´ì—‡ì„ ë§Œë“¤ ê²ƒì¸ì§€:", "lines": 1},
              {"icon": "ğŸ“‹", "label": "ê¸°ì¤€(S)", "prompt": "í‰ê°€ ê¸°ì¤€:", "lines": 1}
            ]
          },
          {
            "id": "q18",
            "number": 18,
            "type": "planning_sheet",
            "question": "ã€ìˆ˜í–‰ê³¼ì œ ê³„íšì„œã€‘",
            "sections": [
              {"label": "ìš°ë¦¬ì˜ ë¹… ì•„ì´ë””ì–´ë¥¼ ì–´ë–»ê²Œ ì ìš©í•  ê²ƒì¸ê°€?", "lines": 2},
              {"label": "í•„ìš”í•œ ìë£Œ/ì¤€ë¹„ë¬¼:", "lines": 2},
              {"label": "ì—­í•  ë¶„ë‹´:", "lines": 2},
              {"label": "ì¼ì • ê³„íš:", "lines": 2}
            ]
          },
          {
            "id": "q19",
            "number": 19,
            "type": "rubric_check",
            "question": "ã€ìê¸° ì ê²€í‘œã€‘ ìˆ˜í–‰ê³¼ì œë¥¼ ì ê²€í•´ ë´…ì‹œë‹¤.",
            "criteria": [
              {"item": "ë¹… ì•„ì´ë””ì–´ê°€ ì˜ ë°˜ì˜ë˜ì—ˆë‚˜ìš”?", "options": ["â­â­â­", "â­â­", "â­"]},
              {"item": "ì²­ì¤‘ì„ ê³ ë ¤í–ˆë‚˜ìš”?", "options": ["â­â­â­", "â­â­", "â­"]},
              {"item": "ì°½ì˜ì ìœ¼ë¡œ í‘œí˜„í–ˆë‚˜ìš”?", "options": ["â­â­â­", "â­â­", "â­"]},
              {"item": "í˜‘ë ¥í•˜ì—¬ ì™„ì„±í–ˆë‚˜ìš”?", "options": ["â­â­â­", "â­â­", "â­"]}
            ]
          }
        ]
      },
      {
        "id": "section-reflect",
        "sectionNumber": 7,
        "title": "ğŸª 7ë‹¨ê³„: ì„±ì°°í•˜ê¸° (Reflect)",
        "stage": "reflect",
        "periods": "10ì°¨ì‹œ",
        "phase": "ê°œë…ì„±ì°°",
        "stageColor": "#6366F1",
        "instructions": "ë‹¨ì› í•™ìŠµì„ ëŒì•„ë³´ë©° ë‚˜ì˜ ì„±ì¥ì„ í™•ì¸í•©ë‹ˆë‹¤.",
        "questions": [
          {
            "id": "q20",
            "number": 20,
            "type": "thinking_change",
            "question": "ã€ì˜ˆì „ì—ëŠ”-ì§€ê¸ˆì€ã€‘ ë‚˜ì˜ ìƒê°ì€ ì–´ë–»ê²Œ ë³€í–ˆë‚˜ìš”?",
            "before": {
              "label": "ì˜ˆì „ì—ëŠ” '${conceptLens}'ì— ëŒ€í•´ ì´ë ‡ê²Œ ìƒê°í–ˆì–´ìš”:",
              "lines": 3
            },
            "after": {
              "label": "ì§€ê¸ˆì€ ì´ë ‡ê²Œ ìƒê°í•´ìš”:",
              "lines": 3
            },
            "reason": {
              "label": "ë‚´ ìƒê°ì´ ë°”ë€ ì´ìœ :",
              "lines": 2
            }
          },
          {
            "id": "q21",
            "number": 21,
            "type": "3_2_1_summary",
            "question": "ã€3-2-1 ì •ë¦¬ã€‘",
            "items": [
              {"number": "3", "label": "ìƒˆë¡­ê²Œ ì•Œê²Œ ëœ ê²ƒ 3ê°€ì§€:", "subLines": 3},
              {"number": "2", "label": "ì¸ìƒ ê¹Šì—ˆë˜ ê²ƒ 2ê°€ì§€:", "subLines": 2},
              {"number": "1", "label": "ë” ê¶ê¸ˆí•œ ê²ƒ 1ê°€ì§€:", "subLines": 1}
            ]
          },
          {
            "id": "q22",
            "number": 22,
            "type": "self_assessment_table",
            "question": "ã€ìê¸°í‰ê°€ã€‘ ë‚˜ì˜ íƒêµ¬ ê³¼ì •ì„ ëŒì•„ë´…ì‹œë‹¤.",
            "criteria": [
              {"item": "í•µì‹¬ ê°œë…(${conceptLens})ì„ ì´í•´í–ˆë‚˜ìš”?"},
              {"item": "íƒêµ¬ í™œë™ì— ì ê·¹ì ìœ¼ë¡œ ì°¸ì—¬í–ˆë‚˜ìš”?"},
              {"item": "ë¹… ì•„ì´ë””ì–´ë¥¼ ë°œê²¬í•˜ê³  ì´í•´í–ˆë‚˜ìš”?"},
              {"item": "ìƒˆë¡œìš´ ìƒí™©ì— ì ìš©í•  ìˆ˜ ìˆë‚˜ìš”?"},
              {"item": "ì¹œêµ¬ë“¤ê³¼ í˜‘ë ¥í•˜ì—¬ í•™ìŠµí–ˆë‚˜ìš”?"}
            ],
            "scale": ["â­â­â­ ì˜í•¨", "â­â­ ë³´í†µ", "â­ ë…¸ë ¥ìš”í•¨"]
          },
          {
            "id": "q23",
            "number": 23,
            "type": "final_reflection",
            "question": "ã€ë‹¨ì›ì„ ë§ˆì¹˜ë©°ã€‘",
            "subQuestions": [
              {"label": "ì´ ë‹¨ì›ì—ì„œ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ë°°ìš´ ê²ƒ:", "lines": 2},
              {"label": "ì‹¤ìƒí™œì—ì„œ í™œìš©í•  ìˆ˜ ìˆëŠ” ì :", "lines": 2},
              {"label": "ì•ìœ¼ë¡œ ë” íƒêµ¬í•˜ê³  ì‹¶ì€ ê²ƒ:", "lines": 2}
            ]
          }
        ]
      }
    ],
    "footer": {
      "teacherComment": true,
      "teacherCommentPrompt": "ì„ ìƒë‹˜ì˜ í”¼ë“œë°±",
      "parentSignature": false,
      "portfolioNote": "ğŸ“ ì´ í•™ìŠµì§€ëŠ” í¬íŠ¸í´ë¦¬ì˜¤ë¡œ ë³´ê´€ë©ë‹ˆë‹¤."
    }
  },
  "teacherGuide": {
    "overview": "ì´ í•™ìŠµì§€ëŠ” ${totalPeriods}ì°¨ì‹œì— ê±¸ì¹œ ì „ë¶í˜• CBI 7ë‹¨ê³„ íƒêµ¬ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.",
    "sampleAnswers": [
      {"questionNumber": 5, "answer": "(ë¹ˆì¹¸ ì±„ìš°ê¸° ì˜ˆì‹œ ë‹µì•ˆ)"},
      {"questionNumber": 14, "answer": "(ë¹… ì•„ì´ë””ì–´ ì˜ˆì‹œ ë‹µì•ˆ)"},
      {"questionNumber": 15, "answer": "(ë°˜ ì „ì²´ ë¹… ì•„ì´ë””ì–´ ì˜ˆì‹œ)"}
    ],
    "commonMisconceptions": [
      "(ì´ ë‹¨ì›ì—ì„œ ì˜ˆìƒë˜ëŠ” ì˜¤ê°œë… 1)",
      "(ì´ ë‹¨ì›ì—ì„œ ì˜ˆìƒë˜ëŠ” ì˜¤ê°œë… 2)",
      "(ì˜¤ê°œë…ì— ëŒ€í•œ ì§€ë„ ë°©ë²•)"
    ]
  }
}

## âš ï¸ ë§¤ìš° ì¤‘ìš”í•œ í•™ìŠµì§€ ì„¤ê³„ ì›ì¹™

### 1. ì‹¤ì œ ì‘ì„± ê°€ëŠ¥í•œ í˜•íƒœ
- ëª¨ë“  ì§ˆë¬¸ì€ í•™ìƒì´ **ì§ì ‘ ì‘ì„±**í•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤
- ë¹ˆì¹¸, í‘œ, ì„  ê¸‹ê¸° ê³µê°„ ë“±ì„ ì œê³µí•´ì•¼ í•©ë‹ˆë‹¤
- "~í•˜ëŠ” í™œë™ì…ë‹ˆë‹¤" ê°™ì€ ì„¤ëª…ë§Œ ìˆìœ¼ë©´ ì•ˆ ë©ë‹ˆë‹¤

### 2. ë‹¨ì› ë‚´ìš© ë°˜ì˜ (ë§¤ìš° ì¤‘ìš”!)
- ëª¨ë“  ì§ˆë¬¸ê³¼ í™œë™ì€ **ì‹¤ì œ ë‹¨ì› ë‚´ìš©**ì— ë§ê²Œ êµ¬ì²´í™”í•´ì•¼ í•©ë‹ˆë‹¤
- í…œí”Œë¦¿ì˜ "(êµ¬ì²´ì ì¸ ë‚´ìš©)", "(ì‚¬ë¡€ ì´ë¦„)" ë“±ì€ **ì‹¤ì œ ë‚´ìš©ìœ¼ë¡œ ëŒ€ì²´**í•˜ì„¸ìš”
- ë¹ˆì¹¸ ì±„ìš°ê¸°ëŠ” **ì‹¤ì œ í•™ìŠµí•  ë‚´ìš©**ì— ê¸°ë°˜í•´ì•¼ í•©ë‹ˆë‹¤

### 3. í•™ë…„ ìˆ˜ì¤€ ì í•©ì„±
- ${grade}í•™ë…„ ìˆ˜ì¤€ì— ë§ëŠ” ì–´íœ˜ì™€ ë‚œì´ë„
- ì§ˆë¬¸ì€ ëª…í™•í•˜ê³  ì´í•´í•˜ê¸° ì‰½ê²Œ

### 4. ë‹¤ì–‘í•œ í™œë™ ìœ í˜•
- ë‹¨ë‹µí˜•, ì„œìˆ í˜•, í‘œ ì±„ìš°ê¸°, ê·¸ë˜í”½ ì¡°ì§ì ë“± í˜¼í•©
- ì‚¬ê³ ë£¨í‹´ í™œë™ í¬í•¨ (See-Think-Wonder, í”„ë ˆì´ì–´ ëª¨ë¸ ë“±)

### 5. ì¶©ë¶„í•œ ì‘ì„± ê³µê°„
- ê° ì§ˆë¬¸ì— ì ì ˆí•œ ì¤„ ìˆ˜ ì œê³µ
- í‘œì™€ ë‹¤ì´ì–´ê·¸ë¨ ê³µê°„ í™•ë³´

ë°˜ë“œì‹œ ìœ íš¨í•œ JSON í˜•ì‹ìœ¼ë¡œë§Œ ì‘ë‹µí•˜ì„¸ìš”.
**í…œí”Œë¦¿ì˜ ê´„í˜¸ ì•ˆ ë‚´ìš©ì€ ë°˜ë“œì‹œ ì‹¤ì œ ë‹¨ì› ë‚´ìš©ìœ¼ë¡œ ëŒ€ì²´í•˜ì„¸ìš”!**`;
};
